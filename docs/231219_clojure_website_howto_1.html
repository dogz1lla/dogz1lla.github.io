<!DOCTYPE html>
<html><head><title>Making a personal website with clojure</title><link href="resources/public/css/styles.css" rel="stylesheet" type="text/css"><link href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.css" rel="stylesheet" type="text/css"><script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js" type="text/javascript"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/clojure.min.js" type="text/javascript"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/python.min.js" type="text/javascript"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/bash.min.js" type="text/javascript"></script></head><body id="title-screen-body"><script>hljs.highlightAll();</script><div class="row"><div class="column left"><img class="avatar" src="resources/public/imgs/pixelz1lla.jpg"><p>Welcome to dogz1lla's lair</p><p><a href="http://github.com/dogz1lla">my github</a></p><p>If you find information on this website helpful/interesting/enjoyable consider donating!</p><p>(all donations are non-refundable!)</p><p> My monero (XMR) wallet:</p><img class="monero-qr" src="resources/public/imgs/website_address.png"></div><div class="column center"><div id="article-page"><div id="header-links">[ <a href="https://dogz1lla.github.io//index.html">Title page</a> | <a href="https://dogz1lla.github.io//home.html">List of articles</a> ]</div><h1>Making a personal website with clojure</h1><p>In this article I will briefly describe how I went about creating my own website using clojure programming language.</p><p>To help me create and publish posts I used emacs' org-mode.</p><p>Please note that </p><ul><li>I made a static website so no <code>clojurescript</code> shenanigans necessary;</li><li>this article won't touch upon the deployment of the resulting web application, I will share my experience with that in another article!</li></ul><h2>Setting up your own (static) website using clojure</h2><h3>Why clojure?</h3><p><a href="https://clojure.org">Clojure</a> is a modern functional programming language that happens to be a lisp. It is an absolute pleasure to work with! If you have some spare time and you would not mind spending it learning a lean, elegant and practical programming language I highly recommend giving clojure a shot. </p><h3><code>lein</code> or <code>deps.edn</code>?</h3><p>Now there are at least two ways to go about building clojure projects.</p><p>One of them is to use <a href="https://leiningen.org">leiningen</a> which has been a de-facto building tool for clojure for quite some time. Some consider its capabilities to be a bit too excessive in volume if not overwhelming and I am one of those people. So I personally went with an alternative which is <a href="https://clojure.org/reference/deps_and_cli">clojure CLI</a>, to me it seems like a leaner and more transparent choice. </p><h3>Clojure libs</h3><p>Which clojure libraries do we need to create a website?</p><p>Well, since the website is going to be static and overall very basic we won't need to use <code>clojurescript</code> and can get away with plain clojure code.</p><p>Two main parts required are:</p><ul><li><i>web server and routing</i>: this is taken care of by using <a href="https://github.com/ring-clojure/ring">ring</a> / <a href="https://github.com/weavejester/compojure">compojure</a> combo;</li><li><i>static web page generation</i>: a very common choice for this is <a href="https://github.com/weavejester/hiccup">hiccup</a>. Nice thing about <code>hiccup</code> is that it allows one to create html using clojure data structures which opens up all of the power of clojure to use for composingthe html tree.</li></ul><p>Above I mentioned that I used clojure CLI for this project and all of the configuration in this tool is done using a special file with the name <code>deps.edn</code> that contains plain clojure data structures. One specifies among other things the dependencies of the project in <code>deps.edn</code> and for our simple website it looks like the following:</p><pre><code class="clojure">{:paths [&quot;src&quot; &quot;resources&quot;]
 :deps
 {org.clojure/clojure     {:mvn/version &quot;1.10.2&quot;}
  compojure/compojure     {:mvn/version &quot;1.6.1&quot;}
  ring/ring-defaults      {:mvn/version &quot;0.3.2&quot;}
  ring/ring-jetty-adapter {:mvn/version &quot;1.7.1&quot;}}}
</code></pre><p>You might have noticed the key <code>:paths</code> in the example above, the corresponding value contains a list of strings that specify folders containing code/files relevant to building the project. In our example we need to specify the folder that contains all of the source code (<code>src</code>) and the folder that contains any static files (i.e., <code>.html</code> or <code>.css</code> or others, <code>resources</code>)</p><h2>Generating static html documents using emacs org mode</h2><p>Let me get this straight: <code>hiccup</code> is a great tool. It was especially useful when generating the overall style of the website: I was able to wrap <code>hiccup</code> code snippets into a clojure function and call it every time I generate a new &quot;view&quot; (effectively on every new webpage).</p><p>However, writing bigger text documents such as this article that contain prose/code snippets is a task I'd like to do in a proper text editor.</p><p><code>Emacs</code> and its amazing <code>org-mode</code> to the rescue!</p><p><a href="https://orgmode.org">Org mode</a> is, in my humble opinion, is the biggest reason  to use <code>emacs</code> (GNU text editor).</p><p>What is <code>org-mode</code>?</p><p>It is a markdown language that allows one to create beatifully formatted text  documents with little effort. It also has in-built facilities to export the documents into plain text/pdf/html and other formats. I used <code>org-mode</code> to write up this article and then exported it to an html document using <code>Ctrl-c Ctrl-e Ctrl-b h h</code> button combination.</p><p>Notice the <code>Ctrl-b</code> bit â€“ it is important because it allows to export only the &quot;body&quot; of the document, i.e., disregarding the <code>&lt;html&gt;</code> and <code>&lt;head&gt;</code> tags. I don't want to have those because that is html that is common to all of the webpages on my website and I would like to generate that in clojure using <code>hiccup</code>. </p><p>One note here: org documents allow one to tweak the export behaviour using special headers. I found it useful to include the following in the begining of my org article document:</p><pre><code class="bash">#+TITLE: The title of your article goes here!
#+OPTIONS: toc:nil html-head-include-default-style:nil num:nil
</code></pre><p></p><p>Notice the <code>OPTIONS</code> key.</p><p>Corresponding values do the following:</p><ul><li><code>toc:nil</code> disables the table of contents;</li><li><code>html-head-include-default-style:nil</code> tells org to disregard the defaul cssorg uses when exporting documents to html (I would like to use my own stylesheet!);</li><li><code>num:nil</code> turns off the numbering of the headlines (matter of personalpreference!);</li></ul><h2>Letting clojure know about the article document</h2><p>Now we have a clojure web server that is responsible for creating templates for the webpages and reading css file among other things and we have html document that contains the article text. To make them work together I created a simple view function</p><pre><code class="clojure">(defn article-page
  &quot; Create an html page for the blog post that has been
  written in org mode and exported to the html file
  `filepath`.&quot;
  [filepath]
  (hiccup.page/html5
    ;; add code to generate the head of the web page here
    [:body
      (slurp filepath)]))
</code></pre><p></p><p>As you can see, adding the blog post is simply letting clojure slurp the html document!</p><h2>Running the server using clojure CLI</h2><p>When everything is ready it is time to do a test run locally. There has to be an entry point to the app, which simply means a function that starts a <code>ring</code> web server: </p><pre><code class="clojure">(defn -main
  [&amp; args]
  (ring.adapter.jetty/run-jetty app-routes {:port 3000}))
</code></pre><p></p><p>where <code>app-routes</code> is definition of the routing you would like to have that is created using <code>compojure</code>'s <code>defroutes</code> macro.</p><p>Now <code>cd</code> into your project directory and execute in the terminal </p><pre><code class="bash">clj -X your_project_name.main_clj_file_name/-main
</code></pre><p></p><p>and the server will start. You should be able to see your webapp if you go to <code>http://localhost:3000/</code> in your browser!</p></div></div></div></body></html>